- name: íŒŒì¼ ì •ë¦¬
  run: |
    # 1) src í´ë”ê°€ ì—†ìœ¼ë©´ ìƒˆë¡œ ë§Œë“ ë‹¤
    mkdir -p src

    # 2) generated.txtë¥¼ ì´ë™í•˜ëŠ”ë°, ì‹¤íŒ¨í•´ë„ ë¬´ì‹œ
    mv generated.txt src/new_code.js || true

permissions:
  contents: write
  pull-requests: write

on:
  workflow_dispatch:

jobs:
  generate-and-pr:
    runs-on: ubuntu-latest
    steps:
      â€¦ # ìƒëµ

# ìˆ˜ë™ìœ¼ë¡œ ì‹¤í–‰í•˜ê±°ë‚˜, ì›í•˜ëŠ” ì´ë²¤íŠ¸ì— ë§ì¶° ë°”ê¿”ë„ ë©ë‹ˆë‹¤.
on:
  workflow_dispatch:

jobs:
  generate-and-pr:
    runs-on: ubuntu-latest
    steps:
      # 1) í˜„ì¬ ì½”ë“œ ë‚´ë ¤ë°›ê¸°
      - uses: actions/checkout@v3

      # 2) Codex API í˜¸ì¶œí•´ì„œ ì½”ë“œ ìƒì„±Â·ìˆ˜ì •
      - name: Codexë¡œ ì½”ë“œ ìƒì„±
        run: |
          curl https://api.openai.com/v1/completions \
            -H "Authorization: Bearer ${{ secrets.OPENAI_API_KEY }}" \
            -H "Content-Type: application/json" \
            -d '{
                  "model": "code-davinci-002",
                  "prompt": "ì—¬ê¸°ì— ì‘ì—… ì§€ì‹œë¬¸ì„ í•œë‘ ë¬¸ì¥ìœ¼ë¡œ ì¨ì£¼ì„¸ìš”",
                  "max_tokens": 500
                }' > generated.txt
          mv generated.txt src/new_code.js || true

      # 3) ë³€ê²½ëœ íŒŒì¼ì„ ìƒˆ ë¸Œëœì¹˜ì— ì»¤ë°‹í•˜ê³  PR ë§Œë“¤ê¸°
      - name: ìë™ìœ¼ë¡œ Pull Request ë§Œë“¤ê¸°
        uses: peter-evans/create-pull-request@v4
        with:
          # ë¸Œëœì¹˜ ì´ë¦„ ê·œì¹™: codex-update-<ìˆ«ì>
          branch: codex-update-${{ github.run_number }}
          commit-message: "Codex ì—…ë°ì´íŠ¸: ì½”ë“œ ìƒì„±/ìˆ˜ì •"
          title: "ğŸ¤– Codex ìë™ ì—…ë°ì´íŠ¸ PR"
          body: |
            ì´ PRì€ Codexê°€ ìë™ìœ¼ë¡œ ìƒì„±Â·ìˆ˜ì •í•œ ì½”ë“œë¥¼ ë‹´ê³  ìˆìŠµë‹ˆë‹¤.
