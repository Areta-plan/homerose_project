permissions:
  contents: write        # ì½”ë“œ ë³€ê²½(ì»¤ë°‹, í‘¸ì‹œ) í—ˆìš©
  pull-requests: write   # PR ìƒì„±Â·ìˆ˜ì • í—ˆìš©

on:
  workflow_dispatch:
name: Codex ìë™ PR ìƒì„±

permissions:
  contents: write
  pull-requests: write

on:
  workflow_dispatch:

jobs:
  generate-and-pr:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Codexë¡œ ì½”ë“œ ìƒì„±
        run: |
          curl https://api.openai.com/v1/completions \
            -H "Authorization: Bearer ${{ secrets.OPENAI_API_KEY }}" \
            -H "Content-Type: application/json" \
            -d '{
                  "model": "code-davinci-002",
                  "prompt": "ì—¬ê¸°ì— ì‘ì—… ì§€ì‹œë¬¸ì„ í•œë‘ ë¬¸ì¥ìœ¼ë¡œ ì¨ì£¼ì„¸ìš”",
                  "max_tokens": 500
                }' > generated.txt

- name: ìë™ìœ¼ë¡œ Pull Request ë§Œë“¤ê¸°
  uses: peter-evans/create-pull-request@v4
  with:
    token: ${{ secrets.GITHUB_TOKEN }}       # â† ì—¬ê¸° ê¼­ ì¶”ê°€!
    branch: codex-update-${{ github.run_number }}
    commit-message: "Codex ì—…ë°ì´íŠ¸: ì½”ë“œ ìƒì„±/ìˆ˜ì •"
    title: "ğŸ¤– Codex ìë™ ì—…ë°ì´íŠ¸ PR"
    body: |
      ì´ PRì€ Codexê°€ ìë™ìœ¼ë¡œ ìƒì„±Â·ìˆ˜ì •í•œ ì½”ë“œë¥¼ ë‹´ê³  ìˆìŠµë‹ˆë‹¤.
